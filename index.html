<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„Ù…ØªØ¬Ø± - Ù‚Ù‡ÙˆØ© Ø­Ø±ÙÙŠØ© ÙˆØ£Ø·Ø¹Ù…Ø© ÙØ§Ø®Ø±Ø©</title>
  <link rel="stylesheet" href="assets/css/styles.css">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <!-- Ù…Ù„Ù Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase -->
  <script src="firebase-config.js"></script>

  <style>
   /* âœ… Ø³ØªØ§ÙŠÙ„ Toast */
.toast {
  visibility: hidden;
  min-width: 280px;
  max-width: 400px;
  background: linear-gradient(90deg, #4caf50, #2e7d32); /* Ø§ÙØªØ±Ø§Ø¶ÙŠ: Ù†Ø¬Ø§Ø­ */
  color: #fff;
  text-align: center;
  border-radius: 12px;
  padding: 14px 20px;
  position: fixed;
  z-index: 1000;
  left: 50%;              /* ØªÙˆØ³ÙŠØ· Ø£ÙÙ‚ÙŠ */
  top: 20px;              /* ÙˆØ¶Ø¹Ù‡ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ */
  transform: translateX(-50%) translateY(-30px); /* Ø¶Ø¨Ø· Ø§Ù„ØªÙˆØ³ÙŠØ· Ù…Ø¹ Ø­Ø±ÙƒØ© Ø¯Ø®ÙˆÙ„ */
  font-size: 15px;
  font-weight: bold;
  box-shadow: 0 6px 20px rgba(0,0,0,0.25);
  opacity: 0;
  transition: opacity 0.5s ease, transform 0.5s ease;
}

.toast.show {
  visibility: visible;
  opacity: 1;
  transform: translateX(-50%) translateY(0); /* Ø¥Ø±Ø¬Ø§Ø¹Ù‡ Ù„Ù…ÙƒØ§Ù†Ù‡ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ */
}

.toast.success { background: linear-gradient(90deg, #4caf4fb6, #2e7d3289); }
.toast.error   { background: linear-gradient(90deg, #f4433690, #b71c1c86); }
.toast.info    { background: linear-gradient(90deg, #2195f385, #1565c0); }
  </style>
</head>
<body>
  <!-- Ø±Ø£Ø³ -->
 <header class="site-header">
  <div class="container header__wrap">
    <span class="brand__title">Ù‚Ù‡ÙˆØ© Ø­Ø±ÙÙŠØ© & Ø£Ø·Ø¹Ù…Ø© ÙØ§Ø®Ø±Ø©</span>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« -->
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." />
      <button id="searchBtn">Ø¨Ø­Ø«</button>
    </div>

    <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø³Ù„Ø© -->
    <button id="cartBtn">ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª (<span id="cartCount">0</span>)</button>

    <!-- Ø²Ø± Ø§Ù„ØªÙˆØ§ØµÙ„ -->
    <button id="contactBtn" onclick="window.location.href='mailto:abdelhakimsaqim@gmail.com'">ğŸ“</button>
  </div>
</header>

  <!-- ÙˆØ§Ø¬Ù‡Ø© ØªØ±Ø­ÙŠØ¨ÙŠØ© -->
  <section class="hero">
    <div class="container hero__grid">
      <div class="hero__content">
        <h1 class="hero__title">Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨ÙƒÙ… ÙÙŠ Ù…ØªØ¬Ø±Ù†Ø§</h1>
        <p class="hero__subtitle">Ù†ÙƒÙ‡Ø§Øª ÙØ§Ø®Ø±Ø© ÙˆÙ‚Ù‡ÙˆØ© Ø­Ø±ÙÙŠØ©</p>
        <p class="hero__text">
          Ø§Ø³ØªÙ…ØªØ¹ Ø¨ØªØ¬Ø±Ø¨Ø© ÙØ±ÙŠØ¯Ø© ØªØ¬Ù…Ø¹ Ø¨ÙŠÙ† Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ù…Ø­Ù…Ù‘ØµØ© Ø¨Ø¹Ù†Ø§ÙŠØ© ÙˆØ£Ø´Ù‡Ù‰ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„ÙØ§Ø®Ø±Ø©.
        </p>
      </div>
      <figure class="media">
        <img src="assets/products-img/cafe.png" alt="ØµÙˆØ±Ø© Ø±Ø¦ÙŠØ³ÙŠØ©">
      </figure>
    </div>
  </section>

  <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
  <section id="products" class="offerings">
    <div class="container">
      <header class="section-header">
        <h2 class="section-title">Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§</h2>
        <p class="section-subtitle">Ù…Ø®ØªØ§Ø±Ø§Øª Ù…Ù† Ø£ÙØ¶Ù„ Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§</p>
      </header>
      <div id="productsList" class="cards"></div>
    </div>
  </section>

  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³Ù„Ø© -->
  <div id="cartModal" style="display:none;">
    <h3>Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
    <ul id="cartItems"></ul>
    <button id="confirmOrderBtn">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
    <button onclick="document.getElementById('cartModal').style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>

  <!-- Ù†Ø§ÙØ°Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ -->
  <div id="orderFormModal" style="display:none;">
    <h3>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</h3>
    <form id="orderForm">
      <label>Ø§Ù„Ø§Ø³Ù…:</label>
      <input type="text" id="customerName" required><br>
      <label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</label>
      <input type="text" id="customerCity" required><br>
      <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
      <input type="text" id="customerAddress" required><br>
      <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
      <input type="text" id="customerPhone" required><br>
      <button type="submit">ğŸ“¦ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
    </form>
    <button onclick="document.getElementById('orderFormModal').style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>

  <!-- Ø¹Ù†ØµØ± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (Toast) -->
  <div id="toast" class="toast"></div>

  <!-- ØªØ°ÙŠÙŠÙ„ -->
  <footer class="site-footer" id="contact">
    <div class="container footer__grid">
      <div>
        <h4 class="footer__title">Ø¹Ù†Ù‘Ø§</h4>
        <p class="footer__text">
          Ù‚Ù‡ÙˆØ© Ø­Ø±ÙÙŠØ© ÙˆØ£Ø·Ø¹Ù…Ø© ÙØ§Ø®Ø±Ø©â€”Ù†ÙƒÙ‡Ø§Øª ØªÙØ­Ø§ÙƒÙŠ Ø¯ÙØ¡ Ø§Ù„Ù…Ù‚Ù‡Ù‰ ÙˆØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­ÙØ±ÙØ©.
        </p>
      </div>
    </div>
    <div class="container footer__bottom">
      <small>Â© 2026 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</small>
    </div>
  </footer>
  <!-- Ø¹Ù†ØµØ± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (Toast) -->
<div id="toast" class="toast"></div>

<script>
  let cart = [];
  let allProducts = [];

  // âœ… Toast function (Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø£Ù†ÙŠÙ‚Ø©)
  function showToast(message, type="success") {
    const toast = document.getElementById("toast");
    toast.textContent = message;
    toast.className = "toast show " + type;
    setTimeout(() => { toast.className = toast.className.replace("show " + type, ""); }, 3000);
  }

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Firestore
  async function loadProducts() {
    const productsList = document.getElementById("productsList");
    productsList.innerHTML = "";

    try {
      const snapshot = await db.collection("products").orderBy("createdAt", "desc").get();
      allProducts = [];
      snapshot.forEach(doc => {
        const product = doc.data();
        const id = doc.id;
        allProducts.push({ ...product, id });
      });
      renderProducts(allProducts);
    } catch (error) {
      console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:", error);
      showToast("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª", "error");
    }
  }

  // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
  function renderProducts(products) {
    const productsList = document.getElementById("productsList");
    productsList.innerHTML = "";
    products.forEach(product => {
      const card = document.createElement("article");
      card.className = "card";
      card.innerHTML = `
        <img src="${product.imageUrl}" alt="${product.name}" class="card__media" width="400" height="400">
        <div class="card__body">
          <h3 class="card__title">${product.name}</h3>
          <p class="card__desc">${product.description}</p>
          <div class="card__price">${product.price}DH</div>
          <button id="btn-${product.id}" class="btn-order"
            onclick="toggleCart('${product.id}')">
            Ø§Ø¶Ø§ÙØ© Ø§Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© ğŸ›’
          </button>
        </div>
      `;
      productsList.appendChild(card);
    });
  }

  // Ø¥Ø¶Ø§ÙØ©/Ø¥Ø²Ø§Ù„Ø© Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©
  function toggleCart(id) {
    const product = allProducts.find(p => p.id === id);
    const btn = document.getElementById("btn-" + id);
    const index = cart.findIndex(item => item.id === id);

    if (index === -1) {
      cart.push(product);
      btn.textContent = "âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨";
      btn.className = "btn-cancel";
      showToast("âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©", "success");
    } else {
      cart.splice(index, 1);
      btn.textContent = "ğŸ›’ Ø§Ø¶Ø§ÙØ© Ø§Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©";
      btn.className = "btn-order";
      showToast("âŒ ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©", "error");
    }

    document.getElementById("cartCount").textContent = cart.length;
  }

 // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø© Ù…Ø¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø®Ø¶Ø±
document.getElementById("cartBtn").addEventListener("click", () => {
  const cartItems = document.getElementById("cartItems");
  cartItems.innerHTML = "";
  let totalPrice = 0;

  cart.forEach(item => {
    totalPrice += parseFloat(item.price) || 0;
    const li = document.createElement("li");
    li.innerHTML = `
      <img src="${item.imageUrl}" alt="${item.name}" width="50" style="vertical-align:middle;margin-right:8px;">
      ${item.name} - ${item.price}DH
    `;
    cartItems.appendChild(li);
  });

// âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ Ø£Ø³ÙÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¯ÙˆÙ† Ø±Ù‚Ù… ØªØ±ØªÙŠØ¨
if (cart.length > 0) {
  const totalDiv = document.createElement("div");
  totalDiv.style.fontWeight = "bold";
  totalDiv.style.marginTop = "12px";
  totalDiv.style.color = "#2e7d32"; // Ø£Ø®Ø¶Ø± Ø£Ù†ÙŠÙ‚
  totalDiv.textContent = `Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${totalPrice} DH`;
  cartItems.appendChild(totalDiv);
}

  document.getElementById("cartModal").style.display = "block";
});

  // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨
  document.getElementById("confirmOrderBtn").addEventListener("click", () => {
    document.getElementById("cartModal").style.display = "none";
    document.getElementById("orderFormModal").style.display = "block";
  });

  // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Firestore
  document.getElementById("orderForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("customerName").value;
    const city = document.getElementById("customerCity").value;
    const address = document.getElementById("customerAddress").value;
    const phone = document.getElementById("customerPhone").value;

    try {
      await db.collection("orders").add({
        name,
        city,
        address,
        phone,
        items: cart,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        opened: false
      });

      showToast(`âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨! Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${cart.length}`, "success");
      cart = [];
      document.getElementById("cartCount").textContent = 0;

      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
      document.getElementById("orderFormModal").style.display = "none";

      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
      location.reload();

    } catch (error) {
      console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨:", error);
      showToast("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨", "error");
    }
  });

  // âœ… Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø«
  function performSearch() {
    const query = document.getElementById("searchInput").value.toLowerCase();
    const filtered = allProducts.filter(p =>
      p.name.toLowerCase().includes(query) ||
      p.description.toLowerCase().includes(query)
    );
    renderProducts(filtered);
    if (filtered.length === 0 && query !== "") {
      showToast("â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«", "info");
    }
  }

  // âœ… Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« - ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø©
  document.getElementById("searchInput").addEventListener("input", performSearch);

  // Ø²Ø± Ø§Ù„Ø¨Ø­Ø«
  document.getElementById("searchBtn").addEventListener("click", performSearch);

  // ØªØ´ØºÙŠÙ„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
  loadProducts();

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø¹Ù†Ù‘Ø§
  function scrollToAbout() {
    document.getElementById('contact').scrollIntoView({ behavior: 'smooth' });
  }
</script>
</body>
</html>